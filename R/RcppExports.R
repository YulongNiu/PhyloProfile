# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Use Dollo's parsimony distance to evaluate similarity patterns.
#'
#' Algorithm:
#' 1. Find the latest common ancestors (LCA) for all gain tips.
#' 2. Select the nodes from each tip to the LCA.
#'
#' InferGainNodes(): Infer the present nodes and tips.
#'
#' DolloDist(): Infer the Dollo's parsimony distance.
#'
#' @title Dollo's parsimony distance
#' @param gainList A list of ancestors of each gain tips. In each elements, the first one is the root.
#' @return
#'
#' InferGainNodes(): A vector (with tips) of 1 and 0.
#'
#' DolloDist(): An integer.
#'
#' @examples
#' ## example tree
#' library('ape')
#' testTreeText <- '((((t1, t2),(t3, t4)),t5), (t6, (t7, t8)));'
#' testTree <- read.tree(text = testTreeText)
#' plot(testTree)
#'
#' ## node path
#' pathList <- nodepath(testTree)
#' InferGainNodes(pathList[1])
#' InferGainNodes(pathList[1:3])
#'
#' InferEdge(testTree$edge, pathList, c(0, 0, 0, 0, 1, 1, 1, 1))
#'
#' DolloDist(testTree$edge, pathList, c(0, 0, 0, 0, 1, 1, 1, 1), c(0, 0, 0, 0, 0, 1, 1, 1))
#' DolloDist(testTree$edge, pathList, c(1, 1, 1, 1, 1, 0, 0, 1), c(0, 0, 0, 0, 1, 0, 0, 1))
#' @author Yulong Niu \email{niuylscu@@gmail.com}
#' @rdname dollo
#' @export
InferGainNodes <- function(gainList) {
    .Call('PhyloProfile_InferGainNodes', PACKAGE = 'PhyloProfile', gainList)
}

#' @param edgeMat A edge mat could be generated from the "ape" package.The first row should be (root --> nodes).
#' @param tipPath  A list of ancestors of each gain tips. In each elements, the first one is the root.
#' @param pr A numeric vector indicates the "presence-absence" pattern."pr" should be in the same order with the tips of tree
#' @return A numeric edge present and absent matrix.
#' @rdname dollo
#' @export
InferEdge <- function(edgeMat, tipPath, pr) {
    .Call('PhyloProfile_InferEdge', PACKAGE = 'PhyloProfile', edgeMat, tipPath, pr)
}

#' @param pr1 1st "presence-absence" pattern.
#' @param pr2 2nd "presence-absence" pattern.
#' @inheritParams InferEdge
#' @return A number indicating the Dollo's parsimony distance.
#' @rdname dollo
#' @references \url{https://www.ncbi.nlm.nih.gov/pubmed/?term=17535793}
#' @export
DolloDist <- function(edgeMat, tipPath, pr1, pr2) {
    .Call('PhyloProfile_DolloDist', PACKAGE = 'PhyloProfile', edgeMat, tipPath, pr1, pr2)
}

#' @param x A list only contains unsigned interger vectors.
#' @return A merged numeric vector.
#' @rdname dollo
#' @keywords internal
MergeList <- function(x) {
    .Call('PhyloProfile_MergeList', PACKAGE = 'PhyloProfile', x)
}

#' @param idx Index
#' @param y A unsigned integer vector
#' @return Repeat number of y[idx] in y.
#' @rdname dollo
#' @keywords internal
CountRepeatIdx <- function(idx, y) {
    .Call('PhyloProfile_CountRepeatIdx', PACKAGE = 'PhyloProfile', idx, y)
}

#' @inheritParams SimCor
#' @rdname simdist
#' @export
SimJaccard <- function(pairProfile) {
    .Call('PhyloProfile_SimJaccard', PACKAGE = 'PhyloProfile', pairProfile)
}

#' @inheritParams SimCor
#' @rdname simdist
#' @export
SimMI <- function(pairProfile) {
    .Call('PhyloProfile_SimMI', PACKAGE = 'PhyloProfile', pairProfile)
}

#' @inheritParams SimCor
#' @rdname simdist
#' @export
DistHamming <- function(pairProfile) {
    .Call('PhyloProfile_DistHamming', PACKAGE = 'PhyloProfile', pairProfile)
}

#' @keywords internal
eachMI <- function(p1, p2, p3, n) {
    .Call('PhyloProfile_eachMI', PACKAGE = 'PhyloProfile', p1, p2, p3, n)
}

