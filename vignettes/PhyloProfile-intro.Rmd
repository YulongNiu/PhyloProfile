---
title: "PhyloProfile: a R package for phylogenetic profiling"
author: "\\

	Yulong Niu \\

        College of Life Sciences, Sichuan University, China"
date: "`r Sys.Date()`"
bibliography: PhyloProfileRef.bib
csl: nature.csl
output:
  BiocStyle::html_document:
    toc: true
  BiocStyle::pdf_document:
    toc: true
vignette: >
  %\VignetteIndexEntry{PhyloProfile: a R package for phylogenetic profiling}
  %\VignetteEngine{knitr::rmarkdown}
  %\usepackage[utf8]{inputenc}
---

```{r style, echo=FALSE, results="asis", message=FALSE}
BiocStyle::markdown()
knitr::opts_chunk$set(tidy = FALSE,
                      warning = FALSE,
                      message = FALSE)
```


```{r echo=FALSE, results='hide', message=FALSE}
library('PhyloProfile')
library('magrittr')
library('STRINGdb')
```

# Abstract

[PhyloProfile](https://github.com/YulongNiu/PhyloProfile) contains various analysis methods and visualization of phylogenetic profiles. 

## Preprocess

+ Retrieving phylogenetic profile from the [STRING](http://string-db.org/) database
+ Normalization 
    * Normalized Phylogenetic Profile (NPP)
    * Singular Value Decomposition (SVD)
   
## Supported analysis

+ Co-occurrency methods
    * Jaccard similarity
    * Pearson correlation coefficient
    * mutual information
    * Hamming distance
    * Euclidean distance
+ Model-based methods
    * Maximum likelihood
    * Dollo parsimony distance
+ Downstream analysis
    * Expanding known gene-sets
    * Significant gene-set analysis
    
## Visualization

+ Phylogenetic profile plot
+ correlation matrix plot
+ [Circos](http://circos.ca/) plot
+ [D3](https://d3js.org/) network

# Introduction

Phylogenetic profiling is a bioinformatic technique used to show protein presence and absence across a large number of species. This genomic-context method is based on the assumption that functionally related proteins are likely to evolve in a correlated manner [@pellegrini1999assigning]. It has been successfully applied to detect novel physical protein-protein interactions, new components of biological complexes, and potential linkages in signaling pathways or metabolic processes [@kensche2008practical].

As increasing numbers of sequenced genomes have become available, various online tools and databases has been developed [@cheng2015protphylo; @sadreyev2015phylogene; @ott2012napp; @szklarczyk2014string; @cromar2016phylopro2]. However, systematically analysis of user-defined phylogenetic profile on local computers is still a slow and tedious process. Here, we provided a R package named *[PhyloProfile](https://github.com/YulongNiu/PhyloProfile)* for analyzing and visualizing phylogenetic profiles.

# Construction of phylogenetic profiles

In *[PhyloProfile](https://github.com/YulongNiu/PhyloProfile)*
, a profile with $n$ proteins across $m$ organisms is denoted as a $n \times m$ matrix containing either binning or continuous data. A binning matrix uses 0 and 1 to represent the homologous absence and presence, respectively. A continuous matrix usually consists of specific sequence similarities, for example BLAST bit scores, which need to be normalized before further analysis.

## Read profiles from local files

`PP()` is designed to coerce a matrix to a `PP` class object, for example we read a published profile [@barker2007constrained] stored in a csv-formed file. 

```{r}
library('PhyloProfile')
library('magrittr')
library('STRINGdb')

descPath <- system.file('extdata', package = 'PhyloProfile')
bioinfoPMat <- read.csv(file.path(descPath, 'bioinfoProfile.csv'), row.names = 1) %>% as.matrix
bioinfoP <- PP(bioinfoPMat)

## binning matrix
bioinfoP
```

## Retrieve profiles from the STRING database

The [STRING](http://string-db.org/) database (version 10) provides raw BLAST bit scores of the best hit for more than 2,000 organisms. The bit score matrix (continuous matrix) can be obtained by `PPSTRING()`. 

The organisms supported by STRING:

```{r}
sp <- get_STRING_species(version = '10', species_name = NULL)
head(sp)
```

Retrieve the profile of 5 human proteins:

``` {r}
## species id of Homo sapiens is 9606
## continuous matrix
PPSTRING(speID = 9606, top = 5, n = 2)
```

Set `top = 'all'` for complete human profile, and increase `n` to accelerate the download process if multiple cores are supported on your system.

## Normalization of bit score profiles

Two normalization methods, SVD[@franceschini2015svd; @psomopoulos2013detection] and NPP[@tabach2013identification; @tabach2013human; @sadreyev2015phylogene], are provided for the pre-process of bit score profiles.

``` {r}
## simulation of bit score profile
ppRawBit <- matrix(sample(0:200, 2000 * 1000, replace = TRUE),
                   ncol = 1000,
                   dimnames = list(paste0('protein', 1:2000),
                                   paste0('spe', 1:1000))) %>% PP
ppRawBit

## SVD
Norm(ppRawBit, method = 'SVD', bitCutoff = 100, bitReset = 0, minConserve = 12, trimming = 0.8)

## NPP
Norm(ppRawBit, method = 'NPP', bitCutoff = 60, bitReset = 1, minConserve = 12)
```


# Homepage

Please visit [PhyloProfile homepage](https://github.com/YulongNiu/PhyloProfile) for more information.


# Session Information

Here is the output of `sessionInfo()` on the system on which this document was compiled:

```{r echo=FALSE}
sessionInfo()
```

# References
